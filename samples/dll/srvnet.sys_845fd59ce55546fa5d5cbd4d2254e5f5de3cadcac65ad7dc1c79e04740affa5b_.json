{
  "name": "srvnet.sys",
  "path": "\\\\?\\C:\\Windows\\System32\\drivers\\srvnet.sys",
  "size": 318976,
  "is_64": true,
  "is_lib": false,
  "is_dotnet": false,
  "has_imports": true,
  "has_exports": true,
  "subsystem": 1,
  "subsystem_caption": "Device Drivers And Native Windows processes",
  "libs": [
    "cng.sys",
    "ksecdd.sys",
    "msquic.sys",
    "msrpc.sys",
    "netio.sys",
    "ntoskrnl.exe",
    "tdi.sys"
  ],
  "imports": [
    {
      "lib": "ntoskrnl.exe",
      "count": 237,
      "functions": [
        "EtwProviderEnabled",
        "EtwRegister",
        "EtwSetInformation",
        "EtwUnregister",
        "EtwWrite",
        "EtwWriteTransfer",
        "ExAcquirePushLockExclusiveEx",
        "ExAcquirePushLockSharedEx",
        "ExAcquireResourceExclusiveLite",
        "ExAcquireResourceSharedLite",
        "ExAcquireRundownProtection",
        "ExAcquireSpinLockExclusive",
        "ExAcquireSpinLockShared",
        "ExAllocatePoolWithTag",
        "ExAllocatePoolWithTagPriority",
        "ExBlockOnAddressPushLock",
        "ExDeleteLookasideListEx",
        "ExDeleteNPagedLookasideList",
        "ExDeletePagedLookasideList",
        "ExDeleteResourceLite",
        "ExFlushLookasideListEx",
        "ExFreePoolWithTag",
        "ExGetPreviousMode",
        "ExInitializeLookasideListEx",
        "ExInitializeNPagedLookasideList",
        "ExInitializePagedLookasideList",
        "ExInitializeResourceLite",
        "ExInitializeRundownProtection",
        "ExQueryDepthSList",
        "ExQueueWorkItem",
        "ExReleasePushLockEx",
        "ExReleasePushLockExclusiveEx",
        "ExReleasePushLockSharedEx",
        "ExReleaseResourceLite",
        "ExReleaseRundownProtection",
        "ExReleaseSpinLockExclusive",
        "ExReleaseSpinLockShared",
        "ExRundownCompleted",
        "ExTryAcquirePushLockSharedEx",
        "ExUnblockOnAddressPushLockEx",
        "ExWaitForRundownProtectionRelease",
        "ExpInterlockedFlushSList",
        "ExpInterlockedPopEntrySList",
        "ExpInterlockedPushEntrySList",
        "IoAllocateErrorLogEntry",
        "IoAllocateIrp",
        "IoAllocateMdl",
        "IoAllocateWorkItem",
        "IoClearActivityIdThread",
        "IoCreateDevice",
        "IoDeleteDevice",
        "IoFreeIrp",
        "IoFreeMdl",
        "IoFreeWorkItem",
        "IoGetActivityIdThread",
        "IoGetCurrentProcess",
        "IoGetRelatedDeviceObject",
        "IoGetRequestorProcess",
        "IoInitializeWorkItem",
        "IoQueueThreadIrp",
        "IoQueueWorkItem",
        "IoQueueWorkItemEx",
        "IoReuseIrp",
        "IoSetActivityIdThread",
        "IoSizeofWorkItem",
        "IoUninitializeWorkItem",
        "IoWMIOpenBlock",
        "IoWMIQuerySingleInstance",
        "IoWMIRegistrationControl",
        "IoWMISetNotificationCallback",
        "IoWMIWriteEvent",
        "IoWriteErrorLogEntry",
        "IofCallDriver",
        "IofCompleteRequest",
        "KeAcquireSpinLockAtDpcLevel",
        "KeAcquireSpinLockRaiseToDpc",
        "KeBugCheckEx",
        "KeCancelTimer",
        "KeClearEvent",
        "KeDelayExecutionThread",
        "KeEnterCriticalRegion",
        "KeFlushQueuedDpcs",
        "KeInitializeDpc",
        "KeInitializeEvent",
        "KeInitializeMutex",
        "KeInitializeSpinLock",
        "KeInitializeTimer",
        "KeInitializeTimerEx",
        "KeLeaveCriticalRegion",
        "KeLowerIrql",
        "KeQueryActiveProcessorCountEx",
        "KeQueryMaximumProcessorCountEx",
        "KeQueryTimeIncrement",
        "KeReadStateQueue",
        "KeReleaseMutex",
        "KeReleaseSpinLock",
        "KeReleaseSpinLockFromDpcLevel",
        "KeSetCoalescableTimer",
        "KeSetEvent",
        "KeStackAttachProcess",
        "KeUnstackDetachProcess",
        "KeWaitForSingleObject",
        "KfRaiseIrql",
        "LsaDeregisterLogonProcess",
        "LsaFreeReturnBuffer",
        "LsaLogonUser",
        "LsaLookupAuthenticationPackage",
        "LsaRegisterLogonProcess",
        "MmBuildMdlForNonPagedPool",
        "MmGetSystemRoutineAddress",
        "MmMapLockedPagesSpecifyCache",
        "MmMdlPageContentsState",
        "MmProbeAndLockPages",
        "MmSizeOfMdl",
        "MmUnlockPages",
        "MmUnmapLockedPages",
        "NtAllocateLocallyUniqueId",
        "NtAllocateVirtualMemory",
        "NtCreateFile",
        "NtDeviceIoControlFile",
        "NtFreeVirtualMemory",
        "NtQuerySystemInformation",
        "ObReferenceObjectByHandle",
        "ObSetSecurityObjectByPointer",
        "ObfDereferenceObject",
        "ObfReferenceObject",
        "PoClearPowerRequest",
        "PoCreatePowerRequest",
        "PoDeletePowerRequest",
        "PoRegisterPowerSettingCallback",
        "PoSetPowerRequest",
        "PoUnregisterPowerSettingCallback",
        "ProbeForRead",
        "ProbeForWrite",
        "PsAssignImpersonationToken",
        "PsGetProcessServerSilo",
        "PsIsHostSilo",
        "RtlAbsoluteToSelfRelativeSD",
        "RtlAddAccessAllowedAce",
        "RtlAnsiStringToUnicodeString",
        "RtlAppendUnicodeStringToString",
        "RtlCaptureStackBackTrace",
        "RtlCompareMemory",
        "RtlCompareUnicodeString",
        "RtlCompressBuffer",
        "RtlCopySid",
        "RtlCopyUnicodeString",
        "RtlCreateAcl",
        "RtlCreateSecurityDescriptor",
        "RtlDecompressBufferEx2",
        "RtlDeleteElementGenericTableAvl",
        "RtlEnumerateGenericTableAvl",
        "RtlEnumerateGenericTableLikeADirectory",
        "RtlEqualUnicodeString",
        "RtlFreeOemString",
        "RtlFreeUnicodeString",
        "RtlGUIDFromString",
        "RtlGetCompressionWorkSpaceSize",
        "RtlGetDaclSecurityDescriptor",
        "RtlHashUnicodeString",
        "RtlInitAnsiString",
        "RtlInitString",
        "RtlInitUnicodeString",
        "RtlInitializeGenericTableAvl",
        "RtlInitializeSid",
        "RtlInsertElementGenericTableAvl",
        "RtlIpv4AddressToStringA",
        "RtlIpv4AddressToStringExW",
        "RtlIpv4AddressToStringW",
        "RtlIpv4StringToAddressW",
        "RtlIpv6AddressToStringA",
        "RtlIpv6AddressToStringExW",
        "RtlIpv6AddressToStringW",
        "RtlIpv6StringToAddressExW",
        "RtlIpv6StringToAddressW",
        "RtlIsGenericTableEmptyAvl",
        "RtlLengthRequiredSid",
        "RtlLengthSecurityDescriptor",
        "RtlLengthSid",
        "RtlLookupElementGenericTableAvl",
        "RtlNotifyFeatureUsage",
        "RtlPrefixUnicodeString",
        "RtlQueryFeatureConfiguration",
        "RtlQueryFeatureConfigurationChangeStamp",
        "RtlQueryRegistryValues",
        "RtlRegisterFeatureConfigurationChangeNotification",
        "RtlRunOnceBeginInitialize",
        "RtlRunOnceExecuteOnce",
        "RtlRunOnceInitialize",
        "RtlSetDaclSecurityDescriptor",
        "RtlStringFromGUID",
        "RtlSubAuthoritySid",
        "RtlTimeToSecondsSince1980",
        "RtlUTF8ToUnicodeN",
        "RtlUnicodeStringToInt64",
        "RtlUnicodeStringToInteger",
        "RtlUnicodeStringToOemString",
        "RtlUnregisterFeatureConfigurationChangeNotification",
        "RtlUpcaseUnicodeString",
        "RtlValidRelativeSecurityDescriptor",
        "RtlValidSecurityDescriptor",
        "RtlVerifyVersionInfo",
        "SeAccessCheckEx",
        "SeAuditingWithTokenForSubcategory",
        "SeCaptureSubjectContext",
        "SeFreePrivileges",
        "SeQueryAuthenticationIdToken",
        "SeReleaseSubjectContext",
        "SeReportSecurityEventWithSubCategory",
        "SeSetAuditParameter",
        "VerSetConditionMask",
        "ZwClose",
        "ZwCreateEvent",
        "ZwCreateKey",
        "ZwDeviceIoControlFile",
        "ZwEnumerateValueKey",
        "ZwFsControlFile",
        "ZwLoadDriver",
        "ZwOpenFile",
        "ZwOpenKey",
        "ZwOpenProcessTokenEx",
        "ZwOpenThreadTokenEx",
        "ZwPowerInformation",
        "ZwQueryInformationToken",
        "ZwQueryKey",
        "ZwQueryLicenseValue",
        "ZwQueryValueKey",
        "ZwSetValueKey",
        "ZwUnloadDriver",
        "ZwWaitForSingleObject",
        "__C_specific_handler",
        "_wcsicmp",
        "_wcsupr",
        "bsearch",
        "iswdigit",
        "qsort",
        "wcsstr"
      ]
    },
    {
      "lib": "tdi.sys",
      "count": 6,
      "functions": [
        "TdiCopyBufferToMdl",
        "TdiCopyMdlToBuffer",
        "TdiDeregisterPnPHandlers",
        "TdiIsIPTransportSupported",
        "TdiOpenNetbiosAddress",
        "TdiRegisterPnPHandlers"
      ]
    },
    {
      "lib": "ksecdd.sys",
      "count": 21,
      "functions": [
        "AcquireCredentialsHandleW",
        "BCryptCloseAlgorithmProvider",
        "BCryptCreateHash",
        "BCryptDecrypt",
        "BCryptDestroyHash",
        "BCryptDestroyKey",
        "BCryptDuplicateKey",
        "BCryptEncrypt",
        "BCryptFinishHash",
        "BCryptGenRandom",
        "BCryptGenerateSymmetricKey",
        "BCryptGetProperty",
        "BCryptHashData",
        "BCryptKeyDerivation",
        "BCryptOpenAlgorithmProvider",
        "BCryptSetProperty",
        "FreeCredentialsHandle",
        "ImpersonateSecurityContext",
        "MapSecurityError",
        "QueryContextAttributesW",
        "RevertSecurityContext"
      ]
    },
    {
      "lib": "cng.sys",
      "count": 1,
      "functions": [
        "SystemPrng"
      ]
    },
    {
      "lib": "netio.sys",
      "count": 22,
      "functions": [
        "CancelMibChangeNotify2",
        "ConvertInterfaceGuidToLuid",
        "ConvertInterfaceIndexToLuid",
        "ConvertInterfaceLuidToGuid",
        "ConvertInterfaceLuidToIndex",
        "FreeMibTable",
        "GetIfEntry2",
        "GetIfTable2",
        "GetIpInterfaceTable",
        "GetUnicastIpAddressEntry",
        "GetUnicastIpAddressTable",
        "NmrClientAttachProvider",
        "NmrDeregisterClient",
        "NmrRegisterClient",
        "NmrWaitForClientDeregisterComplete",
        "NotifyIpInterfaceChange",
        "NotifyUnicastIpAddressChange",
        "NsiAllocateAndGetTable",
        "NsiDeregisterChangeNotification",
        "NsiFreeTable",
        "NsiGetAllParameters",
        "NsiRegisterChangeNotification"
      ]
    },
    {
      "lib": "msrpc.sys",
      "count": 11,
      "functions": [
        "I_RpcExceptionFilter",
        "Ndr64AsyncClientCall",
        "RpcAsyncCancelCall",
        "RpcAsyncCompleteCall",
        "RpcAsyncInitializeHandle",
        "RpcBindingBind",
        "RpcBindingCreateW",
        "RpcBindingFree",
        "RpcBindingSetOption",
        "RpcBindingUnbind",
        "RpcSsDestroyClientContext"
      ]
    },
    {
      "lib": "msquic.sys",
      "count": 2,
      "functions": [
        "MsQuicClose",
        "MsQuicOpen"
      ]
    }
  ],
  "exports": {
    "count": 189,
    "functions": [
      "SmbCompressionChainedDecompress",
      "SmbCompressionDecompress",
      "SmbCompressionLegacyDecompress",
      "SmbCryptoCreateApplicationKey",
      "SmbCryptoCreateServerCipherKeys",
      "SmbCryptoCreateSigningKey",
      "SmbCryptoDecrypt",
      "SmbCryptoHashCreate",
      "SmbCryptoHashDestroy",
      "SmbCryptoHashFinish",
      "SmbCryptoHashGetAlgorithmName",
      "SmbCryptoHashGetOutputLength",
      "SmbCryptoHashGetRecommendedSaltSize",
      "SmbCryptoHashUpdate",
      "SmbCryptoIsHashAlgIdValid",
      "SmbCryptoKeyDereference",
      "SmbCryptoKeyTableCreate",
      "SmbCryptoKeyTableDestroy",
      "SmbCryptoKeyTableFind",
      "SmbCryptoKeyTableInsert",
      "SmbCryptoKeyTableRemove",
      "SmbCryptoReadCipherSuiteOrderPolicySetting",
      "SmbCryptoUpdatePreauthIntegrityHashValue",
      "SrvAdminAllowAnonymousAccess",
      "SrvAdminAllowClusterPipeAccess",
      "SrvAdminAllowIdlePowerDownForActivity",
      "SrvAdminAllowIdlePowerDownForOpenFiles",
      "SrvAdminDeleteFsctlPropertyList",
      "SrvAdminDeregisterFile",
      "SrvAdminDeregisterProvider",
      "SrvAdminDeregisterSession",
      "SrvAdminDeregisterTreeConnect",
      "SrvAdminDoesPipeAllowAnonymous",
      "SrvAdminDoesShareAllowAnonymous",
      "SrvAdminEvaluateServerAlias",
      "SrvAdminInhibitIdlePowerDownForActivity",
      "SrvAdminInhibitIdlePowerDownForOpenFiles",
      "SrvAdminInitializeFsctlPropertyList",
      "SrvAdminIsFsctlAllowedForSmb1",
      "SrvAdminIsFsctlAllowedForSmb2",
      "SrvAdminIsScopedName",
      "SrvAdminIsScopedNameEx",
      "SrvAdminNodeGetNextId",
      "SrvAdminNodeGetSignature",
      "SrvAdminNodeInitialize",
      "SrvAdminNodeInvalidateFile",
      "SrvAdminNodeInvalidateSession",
      "SrvAdminNodeUninitialize",
      "SrvAdminNodeVerifySignature",
      "SrvAdminQueryResumeKeyTarget",
      "SrvAdminRefreshAllowedServerNameList",
      "SrvAdminRefreshAnonymousLists",
      "SrvAdminRefreshFsctlPropertyList",
      "SrvAdminRefreshPipeList",
      "SrvAdminRegisterFile",
      "SrvAdminRegisterProvider",
      "SrvAdminRegisterSession",
      "SrvAdminRegisterTreeConnect",
      "SrvAdminRemapPipeName",
      "SrvAdminSetSessionIsCsvUser",
      "SrvAdminSetSessionName",
      "SrvAdminTakeActionToAllowPowerDown",
      "SrvAdminUpdateFileSessionID",
      "SrvAdminValidateSpn",
      "SrvLibAllocateNameList",
      "SrvLibAllocatePipeEa",
      "SrvLibApplyDeviceAcl",
      "SrvLibApplySrvDeviceAcl",
      "SrvLibAuditForceAccess",
      "SrvLibAuditShareAccess",
      "SrvLibAuditShareAddOrDelete",
      "SrvLibAuditShareConnect",
      "SrvLibAuditShareModification",
      "SrvLibAuditSpnCheck",
      "SrvLibAuditSuccessEnabled",
      "SrvLibBufferToHex",
      "SrvLibCheckAccess",
      "SrvLibCleanupIdleLogic",
      "SrvLibCloseCredentialHandle",
      "SrvLibCreateCredentialHandle",
      "SrvLibCreateSelfSD",
      "SrvLibFilePowerManagementClose",
      "SrvLibFilePowerManagementInitialize",
      "SrvLibFilePowerManagementPreventIdle",
      "SrvLibFreeNameList",
      "SrvLibFreePipeEa",
      "SrvLibFreeSrvServiceSD",
      "SrvLibGenerateSrvServiceSD",
      "SrvLibGetBaseFileName",
      "SrvLibGetBinary",
      "SrvLibGetDWord",
      "SrvLibGetMultiSZList",
      "SrvLibGetSelfSid",
      "SrvLibHasClaimsSentinel",
      "SrvLibInitializeIdleLogic",
      "SrvLibIsAdmin",
      "SrvLibIsAnonymous",
      "SrvLibIsDosDeviceName",
      "SrvLibIsDottedDnsName",
      "SrvLibIsDottedQuadAddress",
      "SrvLibIsInteractive",
      "SrvLibIsLoggableError",
      "SrvLibIsNetwork",
      "SrvLibIsNetworkAddress",
      "SrvLibKeyExists",
      "SrvLibLogError",
      "SrvLibLookasideAllocate",
      "SrvLibLookasideCreatePool",
      "SrvLibLookasideDestroyPool",
      "SrvLibLookasideDirectFreeBuffer",
      "SrvLibLookasideDirectNonPagedAllocateBuffer",
      "SrvLibLookasideDirectPagedAllocateBuffer",
      "SrvLibLookasideFlush",
      "SrvLibLookasideFree",
      "SrvLibMarkServerAsIdle",
      "SrvLibMarkServerAsNotIdle",
      "SrvLibParseSpnName",
      "SrvLibQueryCredentialHandle",
      "SrvLibQueryLicensingDWord",
      "SrvLibRetrieveMaximalAccessRightsForUser",
      "SrvLibS4U2SelfAuth",
      "SrvLibS4U2SelfCleanup",
      "SrvLibS4U2SelfInitialize",
      "SrvLibSeAccessCheck",
      "SrvLibSearchNameFromList",
      "SrvLibSetDWord",
      "SrvLibSetSrvErrorLogIgnore",
      "SrvLibStandardizeIpAddress",
      "SrvLibTruncateDnsName",
      "SrvLibUpdateIdleLogic",
      "SrvNetAddServedName",
      "SrvNetAllocateBuffer",
      "SrvNetAllocateBufferNoTransportHeader",
      "SrvNetAllocatePoolWithTag",
      "SrvNetAllocatePoolWithTagPriority",
      "SrvNetAllocateStatisticsQueuesEx",
      "SrvNetCheckEndpointState",
      "SrvNetCloseConnection",
      "SrvNetConnectionWillSign",
      "SrvNetDecrementConnectionActiveCount",
      "SrvNetDeleteServedName",
      "SrvNetDeregisterClient",
      "SrvNetDisableStatisticsQueue",
      "SrvNetDisconnectConnection",
      "SrvNetEnumerateServedName",
      "SrvNetFreeBuffer",
      "SrvNetFreePool",
      "SrvNetGetActiveProcessorCountAtServerStart",
      "SrvNetGetQueueStatistics",
      "SrvNetGetRdmaNicInfo",
      "SrvNetGetServerNameFlags",
      "SrvNetGetStatisticsAndLock",
      "SrvNetHostAddressAndPortToStringA",
      "SrvNetHostAddressAndPortToStringW",
      "SrvNetIncrementConnectionActiveCount",
      "SrvNetInitializeStatisticsQueues",
      "SrvNetIsConnectionTransportLevelEncrypted",
      "SrvNetIsDriverLoaded",
      "SrvNetIsRdmaConnection",
      "SrvNetIsTdiConnection",
      "SrvNetMarkConnectionAuthenticated",
      "SrvNetNotifyClientsUpdateNetname",
      "SrvNetQueryConnectionInformation",
      "SrvNetQueryConnectionRTT",
      "SrvNetQueryRssScalability",
      "SrvNetReadDirectData",
      "SrvNetReceiveData",
      "SrvNetRegisterClient",
      "SrvNetSendData",
      "SrvNetSetConnectionActiveCount",
      "SrvNetSetConnectionInboundMessageSizeLimit",
      "SrvNetSetConnectionInformation",
      "SrvNetSetConnectionInstanceId",
      "SrvNetSetConnectionServerName",
      "SrvNetSetEndpointFlag",
      "SrvNetStartClient",
      "SrvNetStopClient",
      "SrvNetUpdateMemStatistics",
      "SrvNetUpdateStatisticsFromQueues",
      "SrvNetValidateMemoryDescriptors",
      "SrvNetWriteDirectData",
      "SrvNotifyGroveler",
      "SrvXsAddPrintJob",
      "SrvXsClosePrinter",
      "SrvXsConnect",
      "SrvXsDisconnect",
      "SrvXsDownLevelAPI",
      "SrvXsOpenPrinter",
      "SrvXsSchedulePrintJob"
    ]
  },
  "hashes": {
    "sha2": "845fd59ce55546fa5d5cbd4d2254e5f5de3cadcac65ad7dc1c79e04740affa5b",
    "ssdeep": "6144:MEgQSi0VhSVBDxAtdVEszI6DQ3R+XR+Zk311Xtox8Ug9/Bgp:HVSNhSdAOyDQ3R+XR+y31/ox06"
  },
  "intent": {
    "intentions": 2,
    "uniq_apis_matched": 16,
    "results": [
      {
        "intent": "Enumerates Credentials From The Windows Credential Manager Password Store",
        "tag": "Credential Access:T1555.004 - Windows Credential Manager",
        "component": "Filesystem",
        "inputs": 4,
        "matches": 1,
        "apis": [
          "AcquireCredentialsHandleW"
        ]
      },
      {
        "intent": "Can Conduct Cryptographic Operations",
        "tag": "Expert Input:IBO.0022 - Windows Cryptography Facilities",
        "component": "Crypto",
        "inputs": 71,
        "matches": 15,
        "apis": [
          "BCryptCloseAlgorithmProvider",
          "BCryptCreateHash",
          "BCryptDecrypt",
          "BCryptDestroyHash",
          "BCryptDestroyKey",
          "BCryptDuplicateKey",
          "BCryptEncrypt",
          "BCryptFinishHash",
          "BCryptGenRandom",
          "BCryptGenerateSymmetricKey",
          "BCryptGetProperty",
          "BCryptHashData",
          "BCryptKeyDerivation",
          "BCryptOpenAlgorithmProvider",
          "BCryptSetProperty"
        ]
      }
    ]
  }
}